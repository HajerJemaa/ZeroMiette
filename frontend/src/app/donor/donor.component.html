<div class="container-fluid py-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card shadow-sm">
        <div class="card-body p-4">
          <h3 class="card-title text-center mb-4">Sign Up</h3>

          <!-- Error Message -->
          @if (errorMessage) {
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
              {{ errorMessage }}
              <button type="button" class="btn-close" (click)="errorMessage = null" aria-label="Close"></button>
            </div>
          }

          <!-- Sign Up Form -->
          <form
            [formGroup]="signUpForm"
            (ngSubmit)="onSubmit()"
            [class]="{'was-validated': formValidated}"
            novalidate>
            <!-- Name -->
            <div class="mb-3">
              <label for="name" class="form-label">Full Name</label>
              <input
                type="text"
                id="name"
                class="form-control"
                formControlName="name"
                placeholder="Enter your full name"
                required>
              <div class="invalid-feedback">
                @if (name?.errors?.['required']) {
                  <span>Full name is required.</span>
                } @else if (name?.errors?.['minlength']) {
                  <span>Full name must be at least 2 characters long.</span>
                }
              </div>
            </div>

            <!-- Username -->
            <div class="mb-3">
              <label for="username" class="form-label">Username</label>
              <input
                type="text"
                id="username"
                class="form-control"
                formControlName="username"
                placeholder="Enter your username"
                required>
              <div class="invalid-feedback">
                @if (username?.errors?.['required']) {
                  <span>Username is required.</span>
                } @else if (username?.errors?.['minlength']) {
                  <span>Username must be at least 3 characters long.</span>
                }
              </div>
            </div>

            <!-- Email -->
            <div class="mb-3">
              <label for="email" class="form-label">Email Address</label>
              <input
                type="email"
                id="email"
                class="form-control"
                formControlName="email"
                placeholder="Enter your email"
                required>
              <div class="invalid-feedback">
                @if (email?.errors?.['required']) {
                  <span>Email is required.</span>
                } @else if (email?.errors?.['email']) {
                  <span>Please enter a valid email address.</span>
                }
              </div>
            </div>

            <!-- Password -->
            <div class="mb-3">
              <label for="password" class="form-label">Password</label>
              <input
                type="password"
                id="password"
                class="form-control"
                formControlName="password"
                placeholder="Enter your password"
                required>
              <div class="invalid-feedback">
                @if (password?.errors?.['required']) {
                  <span>Password is required.</span>
                } @else if (password?.errors?.['minlength']) {
                  <span>Password must be at least 6 characters long.</span>
                }
              </div>
            </div>

            <!-- Confirm Password -->
            <div class="mb-3">
              <label for="confirmPassword" class="form-label">Confirm Password</label>
              <input
                type="password"
                id="confirmPassword"
                class="form-control"
                formControlName="confirmPassword"
                placeholder="Confirm your password"
                required>
              <div class="invalid-feedback">
                @if (confirmPassword?.errors?.['required']) {
                  <span>Confirm password is required.</span>
                } @else if (signUpForm.errors?.['passwordMismatch'] && confirmPassword?.touched) {
                  <span>Passwords do not match.</span>
                }
              </div>
            </div>

            <!-- Region -->
            <div class="mb-3">
              <label for="region" class="form-label">Region</label>
              <select
                id="region"
                class="form-select"
                formControlName="region"
                required>
                <option value="" disabled>Select your region</option>
                @for (regionOption of regions; track regionOption) {
                  <option [value]="regionOption">{{ regionOption }}</option>
                }
              </select>
              <div class="invalid-feedback">
                @if (region?.errors?.['required']) {
                  <span>Region is required.</span>
                }
              </div>
            </div>

            <!-- Address -->
            <div class="mb-3">
              <label for="address" class="form-label">Address</label>
              <input
                type="text"
                id="address"
                class="form-control"
                formControlName="address"
                placeholder="Enter your address"
                required>
              <div class="invalid-feedback">
                @if (address?.errors?.['required']) {
                  <span>Address is required.</span>
                }
              </div>
            </div>

            <!-- Phone Number -->
            <div class="mb-3">
              <label for="number" class="form-label">Phone Number</label>
              <input
                type="tel"
                id="number"
                class="form-control"
                formControlName="number"
                placeholder="Enter your phone number (10 digits)"
                required>
              <div class="invalid-feedback">
                @if (number?.errors?.['required']) {
                  <span>Phone number is required.</span>
                } @else if (number?.errors?.['pattern']) {
                  <span>Please enter a valid 10-digit phone number.</span>
                }
              </div>
            </div>

            <!-- Role -->
            <div class="mb-3">
              <label for="role" class="form-label">Role</label>
              <select
                id="role"
                class="form-select"
                formControlName="role"
                required>
                <option value="" disabled>Select your role</option>
                @for (roleOption of roles; track roleOption) {
                  <option [value]="roleOption">{{ roleOption | titlecase }}</option>
                }
              </select>
              <div class="invalid-feedback">
                @if (role?.errors?.['required']) {
                  <span>Role is required.</span>
                }
              </div>
            </div>

            <!-- Description -->
            <div class="mb-3">
              <label for="description" class="form-label">Description (Optional)</label>
              <textarea
                id="description"
                class="form-control"
                formControlName="description"
                placeholder="Tell us about yourself"
                rows="3"></textarea>
            </div>

            <!-- Sign Up Button -->
            <button
              type="submit"
              class="btn btn-primary w-100"
              [disabled]="loading">
              @if (loading) {
                <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                Signing Up...
              } @else {
                Sign Up
              }
            </button>
          </form>

          <!-- Sign In Link -->
          <div class="text-center mt-3">
            <p>Already have an account? <a [routerLink]="['/User/Authenticate/SignIn']" class="text-primary">Sign In</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>